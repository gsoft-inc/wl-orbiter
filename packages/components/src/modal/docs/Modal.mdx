import { ArgTypes, Meta, C, ArgTypesanvas } from "@storybook/addon-docs";
import { ComponentInfo, Tagline } from "@stories/components";
import { InnerContent, InnerFooter, InnerHeader } from "@components/placeholders";
import { InnerModal, InnerModalTrigger } from "@components/modal";

import * as ModalStories from "./Modal.stories.tsx"

<Meta of={ModalStories} />

# Modal

<Tagline>A modal focus the user’s attention exclusively on one task or piece of information via a dialog that sits on top of the page content.</Tagline>

<ComponentInfo
    usage={"import { Modal, ModalTrigger, Heading, Header, Content, Footer, ModalTriggerContext, useModalTriggerContext } from \"@workleap/orbiter-ui\";"}
    ariaPath="dialogmodal"
    githubPath="/packages/components/src/modal/src"
/>

## Guidelines

### When to use

- To let a user interact with the application without jumping to a new page and interrupting the user's workflow.

### Content

- Provide enough information for the user to be able to take a decision in the spot, or a way to come back to the choice later.
- Not use complex layouts, modals are not pages. Consider using a page when a modal layout is getting too complex.
- Not rely on images or illustrations in order to provide essential information to the user.
- Not ask the user a question right above the button(s).

### Accessibility

- Make sure to autofocus on the first interactive element in the modal, except if it’s a destructive action as it could trigger unwanted behavior.
- Prioritize dismissible modals whenever possible in order to give control to the user.
- Use modals sparingly as it disrupt the user's flow.

### Modal vs Alert

If your modal has no way to be dismissed and requires the user to make a choice use an [Alert](?path=/docs/alert--default-story).

## Usage

### Default

A modal must have an heading and a content.

<Canvas of={ModalStories.Default} />

### Image

A modal can have a side banner [image](?path=/story/chromatic-image--default). Make sure the image has no essential information as it could be cropped in mobile view. Images should not prevent a user from seeing the close button, be conscious of this.

<Canvas of={ModalStories.ImageStory} />

Or an [illustration](?path=/docs/illustration--horizontal). Prefer 1:1 ratio for illustrations to prevent them to render a Modal too high on small resolutions, alternatively in mobile use another illustration that has a 1:1 ratio.

<Canvas of={ModalStories.IllustrationStory} />

### Choice

A modal can offer a choice between 2 options. Keep the copy not too long in order to help the user quickly make his choice.

<Canvas of={ModalStories.Choice} />

### Header

Use an header to provide additional information usually in the form of a link or a tooltip that provides more context to the task at hand. Links should open in a new window.

<Canvas of={ModalStories.HeaderStory} />

### Footer

Use a footer to provide trivial information about content present in the modal, like a step : 1/3.

<Canvas of={ModalStories.FooterStory} />

### Buttons

A modal can have a single [button](?path=/docs/button--default-story). Use a primary [button](?path=/docs/button--default-story) to provide the main action.

<Canvas of={ModalStories.ButtonStory} />

Or a [group of button](?path=/docs/button--default-story#button-group). A maximum of 3 buttons are allowed in a modal, when necessary. The secondary and tertiary actions should be using a secondary variant.

<Canvas of={ModalStories.ButtonGroupStory} />

### Modal context

A modal `isOpen` state or `close` function can be retrieved from `useModalTriggerContext`.

<Canvas of={ModalStories.Context} />

### Dismissable

By default, a modal will dismiss on outside interactions and `esc` keydown. However, in some cases, you might want to force the user to explicitly dismiss the modal with a targeted call to action. This is what the dismissable prop is for.

You can set the `dismissable` prop to `false` and render a call to action which will manually dismiss the popover by calling a `close` function retrieved from the `useModalTriggerContext` hook.

> Inlining the call to `useModalTriggerContext` in `ModalTrigger` will not work.

<Canvas of={ModalStories.CustomClose} />

### Controlled

The `open` state can be handled in controlled mode.

<Canvas of={ModalStories.Controlled} />

### Custom trigger

You don't have to use a `ModalTrigger` component if it doesn't fit your needs. A modal component can be used on it's own with any custom trigger which follow a few rules:

- The custom trigger provide a valid `<DialogTriggerContext>` with a `close` function.
- The custom trigger is responsible of show/hide the modal. This is usually done in combination with an [overlay](?path=/docs/overlay--page) component.

<Canvas of={ModalStories.CustomTrigger} />

## API

### ModalTrigger

<ComponentInfo
    usage={"import { ModalTrigger } from \"@workleap/orbiter-ui\";"}
    inherits={[InnerModalTrigger.defaultElement, "styled-component"]}
    compact
/>

<ArgTypes of={InnerModalTrigger} sort="alpha" />

### Modal

<ComponentInfo
    usage={"import { Modal } from \"@workleap/orbiter-ui\";"}
    slots={["image", "illustration", "heading", "header", "content", "footer", "button", "button-group"]}
    inherits={[InnerModal.defaultElement, "styled-component"]}
    compact
/>

<ArgTypes of={InnerModal} sort="alpha" />

### Heading

<ComponentInfo
    usage={"import { Heading } from \"@workleap/orbiter-ui\";"}
    inherits={[InnerHeading.defaultElement, "styled-component"]}
    compact
/>

<ArgTypes of={InnerHeading} sort="alpha" />

### Header

<ComponentInfo
    usage={"import { Header } from \"@workleap/orbiter-ui\";"}
    inherits={[InnerHeader.defaultElement, "styled-component"]}
    compact
/>

<ArgTypes of={InnerHeader} sort="alpha" />

### Content

<ComponentInfo
    usage={"import { Content } from \"@workleap/orbiter-ui\";"}
    inherits={[InnerContent.defaultElement, "styled-component"]}
    compact
/>

<ArgTypes of={InnerContent} sort="alpha" />

### Footer

<ComponentInfo
    usage={"import { Footer } from \"@workleap/orbiter-ui\";"}
    inherits={[InnerFooter.defaultElement, "styled-component"]}
    compact
/>

<ArgTypes of={InnerFooter} sort="alpha" />
